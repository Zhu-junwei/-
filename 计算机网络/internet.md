
# 协议

## DHCP

DHCP（动态主机配置协议，Dynamic Host Configuration Protocol），是一种网络协议，用于自动分配IP地址和其他网络配置信息给计算机在局域网中。DHCP的主要功能包括：

- IP地址分配： DHCP允许网络中的设备自动获取IP地址，而无需手动配置每个设备的IP地址。这有助于简化网络管理。

- 子网掩码分配： DHCP可以分配子网掩码，帮助确定设备所在的网络子网。

- 默认网关分配： DHCP可以配置设备的默认网关，使其能够与其他网络通信。

- DNS服务器分配： DHCP可以提供DNS服务器的IP地址，以便设备能够解析域名。

- 租约管理： DHCP分配的IP地址是有限期限的，称为租约。设备在租约到期前需要重新向DHCP服务器请求更新。

> 工作在计算机网络的应用层（OSI模型中的第七层）和传输层（第四层）之间。它使用UDP（用户数据报协议）作为传输协议，并使用特定的端口号（通常服务端是UDP 67和客户端UDP 68）进行通信。

可以通过`arp -a`查看MAC地址映射表。

## DNS

DNS（Domain Name System，域名系统）是互联网中用于将域名（例如www.example.com）映射到相应IP地址的系统。DNS协议是一种在应用层使用UDP（User Datagram Protocol）协议的网络协议，用于实现域名解析和地址分配。

以下是DNS协议的主要特点和工作原理：

- 域名层次结构： DNS采用分层次的域名结构，类似于文件系统的层次结构。域名由一系列标签组成，标签之间用点（.）分隔。例如，www.example.com中，".com"是顶级域名（Top-Level Domain，TLD），"example"是二级域名，"www"是子域名。

- 域名解析： 当用户在浏览器中输入一个域名时，操作系统首先检查本地的DNS缓存，如果没有找到相应的IP地址，则向DNS服务器发起查询请求。查询从域名的最右侧开始，逐级向左，直到找到完整的IP地址。

- DNS服务器： DNS服务器分为多个层次。本地DNS服务器通常由Internet服务提供商（ISP）提供，负责响应用户设备的DNS查询。如果本地DNS服务器无法解析域名，它将向更高级别的DNS服务器发出请求，直至找到IP地址或者到达顶级DNS服务器。

- DNS消息格式： DNS消息采用分组（packet）格式。DNS请求和响应消息中包含特定字段，包括标识、标志、问题部分、回答部分、授权部分和附加部分。这些字段包含了查询的域名、查询类型、查询类别以及响应的IP地址等信息。

- DNS缓存： 为了减轻DNS服务器负担，DNS使用缓存机制。DNS服务器在响应查询时会将结果缓存一段时间，以便在相同的查询发生时能够直接返回缓存的结果，而不必再次向上级DNS服务器发起查询。

在Windows系统中，可以使用命令行工具 ipconfig 来查看和刷新DNS缓存。

打开命令提示符（Command Prompt）或PowerShell。
输入以下命令以查看DNS缓存：
```shell
ipconfig /displaydns
```
输入以下命令清空DNS缓存：
```shell
ipconfig /flushdns
```

## NAT

NAT（Network Address Translation，网络地址转换）是一种在计算机网络中常用的技术，用于将私有网络内部的IP地址映射到公共网络上的IP地址。NAT主要有两种形式：静态NAT和动态NAT。

**1. 静态NAT：**
   
- 工作原理： 静态NAT是一种一对一的映射，将私有网络内的每个内部IP地址映射到唯一的外部IP地址。这种映射关系是固定不变的，与特定的内部IP地址关联。

**用途：** 主要用于提供对特定服务的外部访问，例如将内部的Web服务器映射到一个公共IP地址。

**2. 动态NAT：** 

- 工作原理： 动态NAT允许内部网络中的多个设备共享少量的外部IP地址。它使用一个地址池，根据需要动态地将内部设备的IP地址映射到池中的可用外部IP地址。

- 用途： 适用于大量内部设备需要访问互联网，但不是所有设备都需要同时拥有外部IP地址的情况。

**NAT的作用：**

- IP地址转换： 允许在私有网络和公共网络之间使用不同的IP地址，提高IP地址的利用率。

- 安全性提高： 隐藏内部网络的实际IP地址，增加网络的安全性，因为外部网络无法直接访问内部网络的设备。

- 减缓IPv4地址枯竭问题： NAT允许在私有网络中使用保留地址，而无需为每个设备分配唯一的全局IP地址，有助于缓解IPv4地址短缺的问题。

